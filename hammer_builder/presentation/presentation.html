<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>HammerBuilder</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="default/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="default/css/screen.css">
    
    
      
      <link rel="stylesheet" href="custom.css">
      
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="default/js/slides.js"></script>
    
    
      
      <script type="text/javascript" src="jquery-1.7.min.js"></script>
      
    
      
      <script type="text/javascript" src="highcharts.js"></script>
      
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>HammerBuilder</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              1/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Fast Ruby xhtml5 renderer</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              2/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Why?</h1></header>
            
            
            <section><p>I needed xhtml builder for my yet very experimental framework Hammmer. I was looking for theese characteristics:</p>
<ul>
<li>Ruby</li>
<li>Fast</li>
<li>Extensibility for each tag</li>
</ul>
<p>Disadvanteges of other options:</p>
<ul>
<li>Erector - quite high level, no tag extensibility</li>
<li>Markaby - slow</li>
<li>Wee::Brush - extensible but not a standalone gem</li>
<li>Tagz - very slow</li>
<li>Erubis - fast but temlate engine and no tag extensibility</li>
<li>Tenjin - faster but temlate engine and no tag extensibility</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              3/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Syntax</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno"> 1</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno"> 2</span>   <span class="n">xhtml5!</span>
<span class="lineno"> 3</span>   <span class="n">html</span> <span class="k">do</span>
<span class="lineno"> 4</span>     <span class="n">head</span> <span class="p">{</span> <span class="n">title</span> <span class="s1">&#39;my_page&#39;</span> <span class="p">}</span>
<span class="lineno"> 5</span>     <span class="n">body</span> <span class="k">do</span>
<span class="lineno"> 6</span>       <span class="n">div</span> <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s1">&#39;content&#39;</span> <span class="k">do</span>
<span class="lineno"> 7</span>         <span class="nb">p</span> <span class="s2">&quot;my page&#39;s content&quot;</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;centered&#39;</span>
<span class="lineno"> 8</span>       <span class="k">end</span>
<span class="lineno"> 9</span>     <span class="k">end</span>
<span class="lineno">10</span>   <span class="k">end</span>
<span class="lineno">11</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span>
</pre></div>

<p>returns</p>
<div class="highlight"><pre><span class="lineno"> 1</span> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE html&gt;</span>
<span class="lineno"> 2</span> <span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
<span class="lineno"> 3</span>   <span class="nt">&lt;head&gt;</span>
<span class="lineno"> 4</span>     <span class="nt">&lt;title&gt;</span>my_page<span class="nt">&lt;/title&gt;</span>
<span class="lineno"> 5</span>   <span class="nt">&lt;/head&gt;</span>
<span class="lineno"> 6</span>   <span class="nt">&lt;body&gt;</span>
<span class="lineno"> 7</span>     <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
<span class="lineno"> 8</span>       <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;centered&quot;</span><span class="nt">&gt;</span>my page&#39;s content<span class="nt">&lt;/p&gt;</span>
<span class="lineno"> 9</span>     <span class="nt">&lt;/div&gt;</span>
<span class="lineno">10</span>   <span class="nt">&lt;/body&gt;</span>
<span class="lineno">11</span> <span class="nt">&lt;/html&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              4/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Each tag have its own Class</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="o">.</span><span class="n">rclass</span> <span class="c1"># =&gt; #&lt;Class:0x00000001d449b8(HammerBuilder::Formatted.dc[:Div])&gt;</span>
<span class="lineno">2</span> <span class="n">li</span><span class="o">.</span><span class="n">rclass</span>  <span class="c1"># =&gt; #&lt;Class:0x00000001d449b8(HammerBuilder::Formatted.dc[:Li])&gt;</span>
<span class="lineno">3</span> <span class="c1"># rclass is original ruby method #class</span>
<span class="lineno">4</span> 
<span class="lineno">5</span> <span class="n">div</span><span class="o">.</span><span class="n">id</span> <span class="ss">:id</span>                        <span class="c1"># &lt;div id=&quot;id&quot;&gt;&lt;/div&gt;</span>
<span class="lineno">6</span> <span class="n">div</span><span class="o">.</span><span class="n">class</span> <span class="o">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="o">]</span>      <span class="c1"># &lt;div class=&quot;left border&quot;&gt;&lt;/div&gt;</span>
<span class="lineno">7</span> <span class="n">meta</span><span class="o">.</span><span class="n">http_equiv</span> <span class="s2">&quot;content-type&quot;</span>    <span class="c1"># &lt;meta http-equiv=&quot;content-type&quot; /&gt;</span>
<span class="lineno">8</span> <span class="n">a</span><span class="o">.</span><span class="n">onclick</span> <span class="s1">&#39;js&#39;</span>                    <span class="c1"># &lt;a onclick=&quot;js&quot;&gt;&lt;/a&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              5/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Chaining methods</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="o">.</span><span class="n">class</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="s1">&#39;menu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class</span><span class="p">(</span><span class="s1">&#39;border&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">onclick</span><span class="p">(</span><span class="s1">&#39;run();&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">with</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="n">text</span> <span class="s1">&#39;hello&#39;</span>
<span class="lineno">3</span> <span class="k">end</span>
</pre></div>

<p>prints</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;left border&quot;</span> <span class="na">id=</span><span class="s">&quot;menu&quot;</span> <span class="na">onclick=</span><span class="s">&quot;run();&quot;</span><span class="nt">&gt;</span>hello<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>Content block must be last in the chain. No other calls are allowed after block.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="n">text</span> <span class="s1">&#39;content&#39;</span>
<span class="lineno">3</span> <span class="k">end</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="s1">&#39;an_id&#39;</span><span class="p">)</span> <span class="c1"># won&#39;t work</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              6/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Tag's content</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span> <span class="s1">&#39;content&#39;</span>                       <span class="c1"># &lt;div&gt;content&lt;/div&gt;</span>
<span class="lineno">2</span> <span class="n">div</span><span class="o">.</span><span class="n">content</span> <span class="s1">&#39;content&#39;</span>               <span class="c1"># &lt;div&gt;content&lt;/div&gt;</span>
<span class="lineno">3</span> <span class="n">div</span> <span class="ss">:content</span> <span class="o">=&gt;</span> <span class="s1">&#39;content&#39;</span>           <span class="c1"># &lt;div&gt;content&lt;/div&gt;</span>
<span class="lineno">4</span> <span class="n">div</span> <span class="p">{</span> <span class="n">text</span> <span class="s1">&#39;content&#39;</span> <span class="p">}</span>              <span class="c1"># &lt;div&gt;content&lt;/div&gt;</span>
<span class="lineno">5</span> <span class="n">div</span><span class="o">.</span><span class="n">with</span> <span class="p">{</span> <span class="n">text</span> <span class="s1">&#39;content&#39;</span> <span class="p">}</span>         <span class="c1"># &lt;div&gt;content&lt;/div&gt;</span>
<span class="lineno">6</span> <span class="n">div</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="ss">:id</span><span class="p">)</span> <span class="p">{</span> <span class="n">text</span> <span class="s1">&#39;content&#39;</span> <span class="p">}</span>  <span class="c1"># &lt;div id=&quot;id&quot;&gt;content&lt;/div&gt;</span>
<span class="lineno">7</span> <span class="n">div</span><span class="o">.</span><span class="n">id</span> <span class="ss">:id</span> <span class="k">do</span>
<span class="lineno">8</span>   <span class="n">text</span> <span class="s1">&#39;content&#39;</span>
<span class="lineno">9</span> <span class="k">end</span>                                 <span class="c1"># &lt;div id=&quot;id&quot;&gt;content&lt;/div&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              7/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Tag's attributes</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span> <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s1">&#39;menu&#39;</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;left&#39;</span> <span class="c1"># is shortcut for:</span>
<span class="lineno">2</span> <span class="n">div</span><span class="o">.</span><span class="n">attributes</span> <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s1">&#39;menu&#39;</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;left&#39;</span>
</pre></div>

<ul>
<li><code>#attributes</code> calls underlining methods <code>#id</code> and <code>#class</code></li>
<li>If you extend tag by a method, you can call it through <code>#attributes</code></li>
</ul>
<p>Any attribute method you call is immediately appended to output with exception of classes. They are acumulating
until tag is closed.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span> <span class="c1"># &lt;div class=&#39;left center&#39;&gt;&lt;/div&gt;</span>
<span class="lineno">2</span> <span class="n">div</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                   <span class="c1"># &lt;div id=&quot;1&quot; id=&quot;2&quot;&gt;&lt;/div&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              8/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Shortcuts for id and classes</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="o">.</span><span class="n">menu!</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">hidden</span> <span class="c1"># =&gt; &lt;div id=&quot;menu&quot; class=&quot;left hidden&quot;&gt;&lt;/div&gt;</span>
</pre></div>

<p>Content can be passed in the usual way:</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="o">.</span><span class="n">menu!</span> <span class="s1">&#39;content&#39;</span>       <span class="c1"># =&gt; &lt;div id=&quot;menu&quot;&gt;content&lt;/div&gt;</span>
<span class="lineno">2</span> <span class="n">div</span><span class="o">.</span><span class="n">menu!</span> <span class="p">{</span> <span class="nb">p</span> <span class="s1">&#39;content&#39;</span> <span class="p">}</span> <span class="c1"># =&gt; &lt;div id=&quot;menu&quot;&gt;&lt;p&gt;content&lt;/p&gt;&lt;/div&gt;</span>
</pre></div>

<h1>Data attributes</h1>
<div class="highlight"><pre><span class="lineno">1</span> <span class="n">div</span><span class="o">.</span><span class="n">data_secret</span><span class="p">(</span><span class="s2">&quot;I won&#39;t tell.&quot;</span><span class="p">)</span> <span class="c1"># =&gt; &lt;div data-secret=&quot;I won&#39;t tell.&quot;&gt;&lt;/div&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              9/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Getting a builder</h1></header>
            
            
            <section><p>Creating new builder is relatively expensive. There is a pool of builders implemented.</p>
<div class="highlight"><pre><span class="lineno"> 1</span> <span class="k">if</span> <span class="n">am_i_smart?</span>
<span class="lineno"> 2</span>   <span class="n">pool</span> <span class="o">=</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Pool</span><span class="o">.</span><span class="n">new</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span> <span class="c1"># store pool somewhere globalish for reuse</span>
<span class="lineno"> 3</span>   <span class="n">builder</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">get</span> <span class="c1"># =&gt; new builder from pool if there is one, or a newlly created one</span>
<span class="lineno"> 4</span>   <span class="c1"># ... do yours stuff</span>
<span class="lineno"> 5</span>   <span class="n">builder</span><span class="o">.</span><span class="n">release</span> <span class="c1"># resets builder and returns it to the pool</span>
<span class="lineno"> 6</span> <span class="k">else</span>
<span class="lineno"> 7</span>   <span class="n">b</span> <span class="o">=</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span><span class="o">.</span><span class="n">new</span>
<span class="lineno"> 8</span>   <span class="c1"># ... do yours stuff</span>
<span class="lineno"> 9</span>   <span class="c1"># later on builder gets garbage collected</span>
<span class="lineno">10</span> <span class="k">end</span>
</pre></div>

<p>It's yours responsibility not to use builder after you have released it.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="k">if</span> <span class="n">am_i_freaking_smart?</span>
<span class="lineno">2</span>   <span class="n">pool</span> <span class="o">=</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Pool</span><span class="o">.</span><span class="n">new</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span>
<span class="lineno">3</span>   <span class="n">xhtml</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">go_in</span><span class="p">(</span><span class="n">your_data</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">data</span><span class="o">|</span>
<span class="lineno">4</span>     <span class="c1"># render your data ...</span>
<span class="lineno">5</span>   <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span> <span class="c1"># returns xhtml and releases the builder</span>
<span class="lineno">6</span> <span class="k">end</span>
</pre></div>

<p>This way builder doesn't get stored anywhere.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              10/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Contexts TODO</h1></header>
            
            
            <section><p>go_in
set_variables</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              11/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Helpers</h1></header>
            
            
            <section><p>If they are needed they can be mixed directly into Builder's instance</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="kp">extend</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">NumberHelper</span>
<span class="lineno">3</span>   <span class="n">div</span> <span class="n">number_with_precision</span><span class="p">(</span><span class="no">Math</span><span class="o">::</span><span class="no">PI</span><span class="p">,</span> <span class="ss">:precision</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">)</span>
<span class="lineno">4</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml</span> <span class="c1"># =&gt; &lt;div&gt;3.1416&lt;/div&gt;</span>
</pre></div>

<p><em>Be careful when you are using this with <code>Pool</code>. Some instances may have helpers and some don't.</em></p>
<p>Or new builder descendant can be made.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="k">class</span> <span class="nc">MyBuilder</span> <span class="o">&lt;</span> <span class="no">Hammer</span><span class="o">::</span><span class="no">FormattedBuilder</span>
<span class="lineno">2</span>   <span class="kp">include</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">NumberHelper</span>
<span class="lineno">3</span> <span class="k">end</span>
<span class="lineno">4</span> 
<span class="lineno">5</span> <span class="no">MyBuilder</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">6</span>   <span class="n">div</span> <span class="n">number_with_precision</span><span class="p">(</span><span class="no">Math</span><span class="o">::</span><span class="no">PI</span><span class="p">,</span> <span class="ss">:precision</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">)</span>
<span class="lineno">7</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml</span> <span class="c1"># =&gt; &lt;div&gt;3.1416&lt;/div&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              12/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Implementation details - Tag's shared instances</h1></header>
            
            
            <section><p>There are no multiple instances for each tag.
Every tag of the same type share a same instance (unique within the instance of a builder).</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="nb">puts</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="nb">puts</span> <span class="n">div</span><span class="o">.</span><span class="n">object_id</span>
<span class="lineno">3</span>   <span class="nb">puts</span> <span class="n">div</span><span class="o">.</span><span class="n">object_id</span>
<span class="lineno">4</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span><span class="p">)</span>
<span class="lineno">5</span> <span class="c1"># =&gt;</span>
<span class="lineno">6</span> <span class="c1"># 10069200</span>
<span class="lineno">7</span> <span class="c1"># 10069200</span>
<span class="lineno">8</span> <span class="c1"># &lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;</span>
</pre></div>

<p><code>HammerBuilder</code> creates what he can prior to rendering and uses heavily meta-programming, because of that instantiating
the very first instance of builder triggers some magic staff taking about a one second. Creating new builders of the
same class is than much faster and getting builder from a pool is instant.</p>
<p>This won't work:</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="nb">puts</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="n">a</span> <span class="o">=</span> <span class="n">div</span> <span class="s1">&#39;a&#39;</span>
<span class="lineno">3</span>   <span class="n">div</span> <span class="s1">&#39;b&#39;</span>
<span class="lineno">4</span>   <span class="n">a</span><span class="o">.</span><span class="n">class</span> <span class="s1">&#39;class&#39;</span>
<span class="lineno">5</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span><span class="p">)</span>
<span class="lineno">6</span> <span class="c1"># =&gt; &lt;div&gt;a&lt;/div&gt;&lt;div class=&quot;class&quot;&gt;b&lt;/div&gt;</span>
</pre></div>

<p>because when <code>#class</code> is called the second div is being builded.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              13/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Implementation details - DynamicClasses</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">Parent</span>
<span class="lineno"> 2</span>   <span class="k">class</span> <span class="nc">LeftEye</span>
<span class="lineno"> 3</span>     <span class="k">def</span> <span class="nf">to_s</span>
<span class="lineno"> 4</span>       <span class="s1">&#39;left eye&#39;</span>
<span class="lineno"> 5</span>     <span class="k">end</span>
<span class="lineno"> 6</span>   <span class="k">end</span>
<span class="lineno"> 7</span>   <span class="k">class</span> <span class="nc">RightEye</span> <span class="o">&lt;</span> <span class="no">LeftEye</span>
<span class="lineno"> 8</span>     <span class="k">def</span> <span class="nf">to_s</span>
<span class="lineno"> 9</span>       <span class="s1">&#39;next to &#39;</span> <span class="o">+</span> <span class="k">super</span>
<span class="lineno">10</span>     <span class="k">end</span>
<span class="lineno">11</span>   <span class="k">end</span>
<span class="lineno">12</span> <span class="k">end</span>
<span class="lineno">13</span> <span class="k">class</span> <span class="nc">AChild</span> <span class="o">&lt;</span> <span class="no">Parent</span>
<span class="lineno">14</span> <span class="k">end</span>
<span class="lineno">15</span> <span class="k">class</span> <span class="nc">AMutant</span>
<span class="lineno">16</span>   <span class="k">class</span> <span class="nc">LeftEye</span> <span class="o">&lt;</span> <span class="n">superclass</span><span class="o">::</span><span class="no">LeftEye</span>
<span class="lineno">17</span>     <span class="k">def</span> <span class="nf">to_s</span>
<span class="lineno">18</span>       <span class="s1">&#39;laser &#39;</span> <span class="o">+</span> <span class="k">super</span>
<span class="lineno">19</span>     <span class="k">end</span>
<span class="lineno">20</span>   <span class="k">end</span>
<span class="lineno">21</span> <span class="k">end</span>
</pre></div>

<p>How to define <code>AMutant::RihtEye</code> to return <code>"next to laser left eye"</code> ?</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              14/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Implementation details - DynamicClasses 2</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">Parent</span>
<span class="lineno"> 2</span>   <span class="kp">extend</span> <span class="no">DynamicClasses</span>
<span class="lineno"> 3</span>   <span class="n">dynamic_classes</span> <span class="k">do</span>
<span class="lineno"> 4</span>     <span class="n">define</span> <span class="ss">:LeftEye</span> <span class="k">do</span>
<span class="lineno"> 5</span>       <span class="k">def</span> <span class="nf">to_s</span><span class="p">;</span> <span class="s1">&#39;left eye&#39;</span><span class="p">;</span> <span class="k">end</span>
<span class="lineno"> 6</span>     <span class="k">end</span>
<span class="lineno"> 7</span>     <span class="n">define</span> <span class="ss">:RightEye</span><span class="p">,</span> <span class="ss">:LeftEye</span> <span class="k">do</span>
<span class="lineno"> 8</span>       <span class="nb">class_eval</span> <span class="o">&lt;&lt;-</span><span class="no">RUBYCODE</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">,</span> <span class="bp">__LINE__</span><span class="o">+</span><span class="mi">1</span>
<span class="lineno"> 9</span> <span class="sh">        def to_s; &#39;next to &#39; + super; end</span>
<span class="lineno">10</span> <span class="no">      RUBYCODE</span>
<span class="lineno">11</span>     <span class="k">end</span>
<span class="lineno">12</span>   <span class="k">end</span>
<span class="lineno">13</span> <span class="k">end</span>
<span class="lineno">14</span> 
<span class="lineno">15</span> <span class="k">class</span> <span class="nc">AChild</span> <span class="o">&lt;</span> <span class="no">Parent</span>
<span class="lineno">16</span> <span class="k">end</span>
<span class="lineno">17</span> 
<span class="lineno">18</span> <span class="k">class</span> <span class="nc">AMutant</span> <span class="o">&lt;</span> <span class="no">Parent</span>
<span class="lineno">19</span>   <span class="n">dynamic_classes</span> <span class="k">do</span>
<span class="lineno">20</span>     <span class="kp">extend</span> <span class="ss">:LeftEye</span> <span class="k">do</span>
<span class="lineno">21</span>       <span class="k">def</span> <span class="nf">to_s</span><span class="p">;</span> <span class="s1">&#39;laser &#39;</span> <span class="o">+</span> <span class="k">super</span><span class="p">;</span> <span class="k">end</span>
<span class="lineno">22</span>     <span class="k">end</span>
<span class="lineno">23</span>   <span class="k">end</span>
<span class="lineno">24</span> <span class="k">end</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              15/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Implementation details - DynamicClasses 3</h1></header>
            
            
            <section><p>Each class is a diferent object.</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="no">Parent</span><span class="o">.</span><span class="n">dynamic_classes</span><span class="o">[</span><span class="ss">:LeftEye</span><span class="o">]</span> <span class="c1"># =&gt; #&lt;Class:0x00000001d449b8(A.dc[:LeftEye])&gt;</span>
<span class="lineno">2</span> <span class="no">AChild</span><span class="o">.</span><span class="n">dynamic_classes</span><span class="o">[</span><span class="ss">:LeftEye</span><span class="o">]</span> <span class="c1"># =&gt; #&lt;Class:0x00000001d42398(A.dc[:LeftEye])&gt;</span>
</pre></div>

<p><code>AMutant.dc[:RightEye]</code> automaticaly inherits from extended <code>AMutant.dc[:LeftEye]</code></p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="no">Parent</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:LeftEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span>   <span class="c1"># =&gt; &#39;left eye&#39;</span>
<span class="lineno">2</span> <span class="no">Parent</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:RightEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span>  <span class="c1"># =&gt; &#39;next to left eye&#39;</span>
<span class="lineno">3</span> 
<span class="lineno">4</span> <span class="no">AChild</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:LeftEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span>   <span class="c1"># =&gt; &#39;left eye&#39;</span>
<span class="lineno">5</span> <span class="no">AChild</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:RightEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span>  <span class="c1"># =&gt; &#39;next to left eye&#39;</span>
<span class="lineno">6</span> 
<span class="lineno">7</span> <span class="no">AMutant</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:LeftEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span>  <span class="c1"># =&gt; &#39;laser left eye&#39;</span>
<span class="lineno">8</span> <span class="no">AMutant</span><span class="o">.</span><span class="n">dc</span><span class="o">[</span><span class="ss">:RightEye</span><span class="o">].</span><span class="n">new</span><span class="o">.</span><span class="n">to_s</span> <span class="c1"># =&gt; &#39;next to laser left eye&#39;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              16/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Extensibility</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">MyBuilder</span> <span class="o">&lt;</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Formatted</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>   <span class="c1"># define new method to all tags</span>
<span class="lineno"> 4</span>   <span class="n">extend_class</span> <span class="ss">:AbstractTag</span> <span class="k">do</span>
<span class="lineno"> 5</span>     <span class="k">def</span> <span class="nf">hide!</span>
<span class="lineno"> 6</span>       <span class="nb">self</span><span class="o">.</span><span class="n">class</span> <span class="s1">&#39;hidden&#39;</span>
<span class="lineno"> 7</span>     <span class="k">end</span>
<span class="lineno"> 8</span>   <span class="k">end</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span>   <span class="c1"># add pseudo tag</span>
<span class="lineno">11</span>   <span class="n">define_class</span> <span class="ss">:Component</span><span class="p">,</span> <span class="ss">:Div</span> <span class="k">do</span>
<span class="lineno">12</span>     <span class="nb">class_eval</span> <span class="o">&lt;&lt;-</span><span class="no">RUBYCODE</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">,</span> <span class="bp">__LINE__</span> <span class="o">+</span> <span class="mi">1</span>
<span class="lineno">13</span> <span class="sh">      def open(id, attributes = nil, &amp;block)</span>
<span class="lineno">14</span> <span class="sh">        super(attributes, &amp;nil).id(id).class(&#39;component&#39;)</span>
<span class="lineno">15</span> <span class="sh">        block ? with(&amp;block) : self</span>
<span class="lineno">16</span> <span class="sh">      end</span>
<span class="lineno">17</span> <span class="no">    RUBYCODE</span>
<span class="lineno">18</span>   <span class="k">end</span>
<span class="lineno">19</span>   <span class="n">define_tag</span> <span class="ss">:component</span>
<span class="lineno">20</span> 
<span class="lineno">21</span>   <span class="c1"># if the class is not needed same can be done this way</span>
<span class="lineno">22</span>   <span class="k">def</span> <span class="nf">simple_component</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
<span class="lineno">23</span>     <span class="n">div</span><span class="o">[</span><span class="nb">id</span><span class="o">].</span><span class="n">attributes</span> <span class="n">attributes</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span>
<span class="lineno">24</span>   <span class="k">end</span>
<span class="lineno">25</span> <span class="k">end</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              17/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Extensibility 2</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="no">MyBuilder</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">2</span>   <span class="n">div</span><span class="o">[</span><span class="ss">:content</span><span class="o">].</span><span class="n">with</span> <span class="k">do</span>
<span class="lineno">3</span>     <span class="n">span</span><span class="o">[</span><span class="ss">:secret</span><span class="o">].</span><span class="n">class</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hide!</span>
<span class="lineno">4</span>     <span class="n">component</span><span class="p">(</span><span class="s1">&#39;component-1&#39;</span><span class="p">)</span> <span class="k">do</span>
<span class="lineno">5</span>       <span class="n">strong</span> <span class="s1">&#39;something&#39;</span>
<span class="lineno">6</span>     <span class="k">end</span>
<span class="lineno">7</span>     <span class="n">simple_component</span> <span class="s1">&#39;component-1&#39;</span>
<span class="lineno">8</span>   <span class="k">end</span>
<span class="lineno">9</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span>
</pre></div>

<p>returns</p>
<div class="highlight"><pre><span class="lineno">1</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
<span class="lineno">2</span>   <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;secret&quot;</span> <span class="na">class=</span><span class="s">&quot;left hidden&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
<span class="lineno">3</span>   <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;component-1&quot;</span> <span class="na">class=</span><span class="s">&quot;component&quot;</span><span class="nt">&gt;</span>
<span class="lineno">4</span>     <span class="nt">&lt;strong&gt;</span>something<span class="nt">&lt;/strong&gt;</span>
<span class="lineno">5</span>   <span class="nt">&lt;/div&gt;</span>
<span class="lineno">6</span>   <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;component-1&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="lineno">7</span> <span class="nt">&lt;/div&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              18/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>How to use</h1></header>
            
            
            <section><p>The idea is that any object intended to rendering will have methods which renders the object into builder.
There is a <code>HammerBuilder::Helper</code> and method <code>#render</code> for that purpose.</p>
<div class="highlight"><pre><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">Struct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:login</span><span class="p">,</span> <span class="ss">:email</span><span class="p">)</span>
<span class="lineno"> 2</span>   <span class="kp">include</span> <span class="no">HammerBuilder</span><span class="o">::</span><span class="no">Helper</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span>   <span class="n">builder</span> <span class="ss">:detail</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span>
<span class="lineno"> 5</span>     <span class="n">ul</span> <span class="k">do</span>
<span class="lineno"> 6</span>       <span class="n">render</span> <span class="n">user</span><span class="p">,</span> <span class="ss">:attribute</span><span class="p">,</span> <span class="ss">:name</span>
<span class="lineno"> 7</span>       <span class="n">render</span> <span class="n">user</span><span class="p">,</span> <span class="ss">:attribute</span><span class="p">,</span> <span class="ss">:login</span>
<span class="lineno"> 8</span>       <span class="n">render</span> <span class="n">user</span><span class="p">,</span> <span class="ss">:attribute</span><span class="p">,</span> <span class="ss">:email</span>
<span class="lineno"> 9</span>     <span class="k">end</span>
<span class="lineno">10</span>   <span class="k">end</span>
<span class="lineno">11</span> 
<span class="lineno">12</span>   <span class="n">builder</span> <span class="ss">:attribute</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="p">,</span> <span class="n">attribute</span><span class="o">|</span>
<span class="lineno">13</span>     <span class="n">li</span> <span class="k">do</span>
<span class="lineno">14</span>       <span class="n">strong</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">: &quot;</span>
<span class="lineno">15</span>       <span class="n">text</span> <span class="n">user</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
<span class="lineno">16</span>     <span class="k">end</span>
<span class="lineno">17</span>   <span class="k">end</span>
<span class="lineno">18</span> <span class="k">end</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              19/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>How to use 2</h1></header>
            
            
            <section><div class="highlight"><pre><span class="lineno">1</span> <span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Peter&quot;</span><span class="p">,</span> <span class="s2">&quot;peter&quot;</span><span class="p">,</span> <span class="s2">&quot;peter@example.com&quot;</span><span class="p">)</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="n">pool</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">go_in</span> <span class="k">do</span>
<span class="lineno">4</span>   <span class="n">render</span> <span class="n">user</span><span class="p">,</span> <span class="ss">:detail</span>
<span class="lineno">5</span>   <span class="nb">p</span> <span class="s2">&quot;builder methods are: </span><span class="si">#{</span><span class="no">User</span><span class="o">.</span><span class="n">builder_methods</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="lineno">6</span> <span class="k">end</span><span class="o">.</span><span class="n">to_xhtml!</span>
</pre></div>

<p>returns:</p>
<div class="highlight"><pre><span class="lineno"> 1</span> <span class="nt">&lt;ul&gt;</span>
<span class="lineno"> 2</span>   <span class="nt">&lt;li&gt;</span>
<span class="lineno"> 3</span>     <span class="nt">&lt;strong&gt;</span>name: <span class="nt">&lt;/strong&gt;</span>Peter
<span class="lineno"> 4</span>   <span class="nt">&lt;/li&gt;</span>
<span class="lineno"> 5</span>   <span class="nt">&lt;li&gt;</span>
<span class="lineno"> 6</span>     <span class="nt">&lt;strong&gt;</span>login: <span class="nt">&lt;/strong&gt;</span>peter
<span class="lineno"> 7</span>   <span class="nt">&lt;/li&gt;</span>
<span class="lineno"> 8</span>   <span class="nt">&lt;li&gt;</span>
<span class="lineno"> 9</span>     <span class="nt">&lt;strong&gt;</span>email: <span class="nt">&lt;/strong&gt;</span>peter@example.com
<span class="lineno">10</span>   <span class="nt">&lt;/li&gt;</span>
<span class="lineno">11</span> <span class="nt">&lt;/ul&gt;</span>
<span class="lineno">12</span> <span class="nt">&lt;p&gt;</span>builder methods are: detail, attribute<span class="nt">&lt;/p&gt;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              20/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Benchmark Synthetic</h1></header>
            
            
            <section><pre><code>                               user     system      total        real
tenjin-reuse               2.040000   0.000000   2.040000 (  2.055140)
HammerBuilder::Standard    2.520000   0.000000   2.520000 (  2.519284)
fasterubis-reuse           2.580000   0.000000   2.580000 (  2.581407)
erubis-reuse               2.680000   0.000000   2.680000 (  2.690176)
HammerBuilder::Formatted   2.780000   0.000000   2.780000 (  2.794307)
erubis                     5.180000   0.000000   5.180000 (  5.183333)
fasterubis                 5.210000   0.000000   5.210000 (  5.219176)
tenjin                     7.650000   0.160000   7.810000 (  7.820490)
erector                    9.450000   0.010000   9.460000 (  9.471654)
markaby                   14.300000   0.000000  14.300000 ( 14.318844)
tagz                      33.430000   0.000000  33.430000 ( 33.483693)
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              21/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Benchmark Synthetic</h1></header>
            
            
            <section><div id="container" style="width: 800px; height: 500px; margin: 0 auto"></div></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              22/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Benchmark Rails 3</h1></header>
            
            
            <section><pre><code>BenchTest#test_erubis_partials (3.34 sec warmup)
           wall_time: 3.56 sec
             gc_runs: 15
             gc_time: 0.53 ms
BenchTest#test_erubis_single (552 ms warmup)
           wall_time: 544 ms
             gc_runs: 4
             gc_time: 0.12 ms
BenchTest#test_hammer_builder (2.33 sec warmup)
           wall_time: 847 ms
             gc_runs: 5
             gc_time: 0.17 ms
BenchTest#test_tenjin_partial (942 ms warmup)
           wall_time: 1.21 sec
             gc_runs: 7
             gc_time: 0.25 ms
BenchTest#test_tenjin_single (531 ms warmup)
           wall_time: 532 ms
             gc_runs: 6
             gc_time: 0.20 ms
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              23/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Benchmark Rails 3</h1></header>
            
            
            <section><div id="container2" style="width: 800px; height: 250px; margin: 0 auto"></div></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              24/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Why is it fast?</h1></header>
            
            
            <section><ul>
<li>Optimalization of garbage collecting.<ul>
<li>10-15% improvment.</li>
<li>Preinicialization (tag's instances, even strings).</li>
<li>No string's <code>#+</code>, <code>#{}</code>. Just <code>#&lt;&lt;</code> to buffer.</li>
<li>Precomputed spaces for indentation.</li>
</ul>
</li>
<li>Doing as less as posible when rendering.</li>
<li>Magic by metaprograming not by <code>method_missing</code>. Magic is run on inicialization not when rendering.</li>
<li>Number of micro optimalization.<ul>
<li>Data in constants or instance variables.</li>
<li>Buffer.</li>
<li>No <code>#define_method</code>.</li>
<li>Method inlining.</li>
<li>Probably no real effect :)</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              25/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Next?</h1></header>
            
            
            <section><ul>
<li>Sinatra</li>
<li>Rails 3</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              26/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Why use?</h1></header>
            
            
            <section><ul>
<li>Its fast</li>
<li>You can use inheritance (imposible with templates)</li>
<li>You can write in ruby and use all the advatages of the language</li>
<li>TODO</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              27/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Links</h1></header>
            
            
            <section><ul>
<li><strong>Presentation</strong>: <a href="http://hammer.pitr.ch/hammer_builder/presentation/presentation.html">http://hammer.pitr.ch/hammer_builder/presentation/presentation.html</a></li>
<li>Gemcutter: <a href="https://rubygems.org/gems/hammer_builder">https://rubygems.org/gems/hammer_builder</a></li>
<li>Github: <a href="https://github.com/ruby-hammer/hammer-builder">https://github.com/ruby-hammer/hammer-builder</a></li>
<li>Yardoc: <a href="http://rubydoc.info/github/ruby-hammer/hammer-builder/frames">http://rubydoc.info/github/ruby-hammer/hammer-builder/frames</a></li>
<li>Issues: <a href="https://github.com/ruby-hammer/hammer-builder/issues">https://github.com/ruby-hammer/hammer-builder/issues</a></li>
<li>Changelog: <a href="http://hammer.pitr.ch/hammer-builder/file.CHANGELOG.html">http://hammer.pitr.ch/hammer-builder/file.CHANGELOG.html</a></li>
<li>Gem: <a href="https://rubygems.org/gems/hammer_builder">https://rubygems.org/gems/hammer_builder</a></li>
<li>Blog: <a href="http://hammer.pitr.ch/">http://hammer.pitr.ch/</a></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              28/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Thanks for listening / reading.</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              29/30
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>TODO</h1></header>
            
            
            <section><ul>
<li>spellcheck</li>
</ul>
<script type="text/javascript">
  var chart, chart2;
  $(document).ready(function() {
    chart = new Highcharts.Chart({
      chart: { renderTo: 'container', defaultSeriesType: 'bar' },
      title: { text: null },
      xAxis: {
        categories: ["tenjin-reuse",
          "HammerBuilder::Standard",
          "fasterubis-reuse",
          "erubis-reuse",
          "HammerBuilder::Formatted",
          "erubis",
          "fasterubis",
          "tenjin",
          "erector",
          "markaby",
          "tagz"],
        title: { text: null }
      },
      yAxis: { min: 0, title: { text: null }},
      tooltip: { enabled: false },
      plotOptions: {
        area: { backgroundColor: "AAAAAA" },
        series: { animation: false },
        bar: { dataLabels: { enabled: true }}
      },
      legend: { enabled: false },
      credits: { enabled: false },
      series: [
        { name: 'total',
          data: [2.040000,2.520000,2.580000,2.680000,2.780000,5.180000,5.210000,7.810000,9.460000,14.300000,33.430000]
        }
      ]
    });
    chart2 = new Highcharts.Chart({
      chart: { renderTo: 'container2', defaultSeriesType: 'bar' },
      title: { text: null },
      xAxis: {
        categories: ["Tenjin single template",
          "Erubis single template",
          "HammerBuilder::Formatted",
          "Tenjin partial templates",
          "Erubis partial templates"
        ],
        title: { text: null }
      },
      yAxis: { min: 0, title: { text: null }},
      tooltip: { enabled: false },
      plotOptions: {
        area: { backgroundColor: "AAAAAA" },
        series: { animation: false },
        bar: { dataLabels: { enabled: true }}
      },
      legend: { enabled: false },
      credits: { enabled: false },
      series: [
        { name: 'wall time',
          data: [0.532, 0.544, 0.847, 1.210, 3.560]
        }
      ]
    });
  });
</script></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              30/30
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">HammerBuilder</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">Fast Ruby xhtml5 renderer</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Why?</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">Syntax</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Each tag have its own Class</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Chaining methods</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Tag's content</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">Tag's attributes</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">Shortcuts for id and classes</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">Getting a builder</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">Contexts TODO</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">Helpers</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Implementation details - Tag's shared instances</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Implementation details - DynamicClasses</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">Implementation details - DynamicClasses 2</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">Implementation details - DynamicClasses 3</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Extensibility</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Extensibility 2</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">How to use</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">How to use 2</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Benchmark Synthetic</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">Benchmark Synthetic</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">Benchmark Rails 3</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">Benchmark Rails 3</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">Why is it fast?</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">Next?</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">Why use?</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Links</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Thanks for listening / reading.</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">TODO</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>